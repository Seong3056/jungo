{% extends "base.html" %}
{% block title %}{{ listing.title }} - 채팅{% endblock %}
{% block content %}
<div class="container">
  <div class="glass" style="max-width:720px;margin:16px auto;padding:18px;border-radius:16px;">
    <h2 style="margin:0 0 10px;">💬 {{ listing.title }} 채팅</h2>
    <div style="font-size:14px;color:var(--muted);margin-bottom:8px;">
      상대: <strong>{{ partner.username }}</strong>
    </div>
    <div id="message-list" style="max-height:420px;overflow-y:auto;padding:12px;border-radius:12px;background:rgba(255,255,255,0.2);border:1px solid rgba(255,255,255,0.25);">
      {% for msg in messages %}
        <div style="margin-bottom:10px;{% if msg.sender == request.user %}text-align:right;{% endif %}">
          <div style="font-size:12px;color:var(--muted);margin-bottom:2px;">
            {{ msg.sender.username }} · {{ msg.timestamp|date:"Y.m.d H:i" }}
          </div>
          <div class="glass" style="display:inline-block; padding:8px 12px; border-radius:12px;">
            {{ msg.content|linebreaksbr }}
          </div>
        </div>
      {% empty %}
        <div style="color:var(--muted);">아직 메시지가 없습니다.</div>
      {% endfor %}
    </div>
    <form method="post" style="margin-top:12px; display:flex; gap:8px;">
      {% csrf_token %}
      {{ form.message }}
      <button class="btn" type="submit">전송</button>
    </form>
  </div>
</div>
{% endblock %}
